<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="Date-Revision-yyyymmdd" content="20140918"/>
  <meta http-equiv="Content-Language" content="en"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title>Stream Result</title>

  <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,400italic,600italic,700italic" rel="stylesheet" type="text/css">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
  <link href="/css/main.css" rel="stylesheet">
  <link href="/css/custom.css" rel="stylesheet">
  <link href="/highlighter/github-theme.css" rel="stylesheet">

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script type="text/javascript" src="/bootstrap/js/bootstrap.js"></script>
  <script type="text/javascript" src="/js/community.js"></script>
</head>
<body>

<a href="http://github.com/apache/struts" class="github-ribbon">
  <img style="position: absolute; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub">
</a>

<header>
  <nav>
    <div role="navigation" class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" data-toggle="collapse" data-target="#struts-menu" class="navbar-toggle">
            Menu
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a href="/index.html" class="navbar-brand logo"><img src="/img/struts-logo.svg"></a>
        </div>
        <div id="struts-menu" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown">
              <a data-toggle="dropdown" href="#" class="dropdown-toggle">
                Home<b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                <li><a href="/index.html">Welcome</a></li>
                <li><a href="/downloads.html">Downloads</a></li>
                <li><a href="/announce.html">Announcements</a></li>
                <li><a href="http://www.apache.org/licenses/">License</a></li>
                <li><a href="http://apache.org/foundation/thanks.html">Thanks!</a></li>
                <li><a href="http://apache.org/foundation/sponsorship.html">Sponsorship</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a data-toggle="dropdown" href="#" class="dropdown-toggle">
                Support<b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                <li><a href="/mail.html">User Mailing List</a></li>
                <li><a href="https://issues.apache.org/jira/browse/WW">Issue Tracker</a></li>
                <li><a href="/security.html">Reporting Security Issues</a></li>
                <li class="divider"></li>
                <li><a href="/maven/project-info.html">Project info</a></li>
                <li><a href="/maven/struts2-core/dependencies.html">Struts Core dependencies</a></li>
                <li><a href="/maven/struts2-plugins/modules.html">Plugin dependencies</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a data-toggle="dropdown" href="#" class="dropdown-toggle">
                Documentation<b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                <li><a href="/birdseye.html">Birds Eye</a></li>
                <li><a href="/primer.html">Key Technologies</a></li>
                <li><a href="/kickstart.html">Kickstart FAQ</a></li>
                <li><a href="https://cwiki.apache.org/confluence/display/WW/Home">Wiki</a></li>
                <li class="divider"></li>
                <li><a href="/getting-started/">Getting Started</a></li>
                <li><a href="/security/">Security Guide</a></li>
                <li><a href="/core-developers/">Core Developers Guide</a></li>
                <li><a href="/tag-developers/">Tag Developers Guide</a></li>
                <li><a href="/plugins/">Plugins</a></li>
                <li class="divider"></li>
                <li><a href="/maven/struts2-core/apidocs/index.html">Struts Core API</a></li>
                <li><a href="/docs/plugins.html">Plugin APIs</a></li>
                <li><a href="/docs/tag-reference.html">Tag reference</a></li>
                <li><a href="http://cwiki.apache.org/S2PLUGINS/home.html">Plugin registry</a></li>
                <li class="divider"></li>
                <li><a href="/docs/tutorials.html">Tutorials - DEPRECATED</a></li>
                <li><a href="/docs/faqs.html">FAQs - DEPRECATED</a></li>
                <li><a href="/docs/guides.html">Guides - DEPRECATED</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a data-toggle="dropdown" href="#" class="dropdown-toggle">
                Contributing<b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                <li><a href="/youatstruts.html">You at Struts</a></li>
                <li><a href="/helping.html">How to Help FAQ</a></li>
                <li><a href="/dev-mail.html">Development Lists</a></li>
                <li class="divider"></li>
                <li><a href="/submitting-patches.html">Submitting patches</a></li>
                <li><a href="/builds.html">Source Code</a></li>
                <li><a href="/coding-standards.html">Coding standards</a></li>
                <li class="divider"></li>
                <li><a href="/releases.html">Release Guidelines</a></li>
                <li><a href="/bylaws.html">PMC Charter</a></li>
                <li><a href="/volunteers.html">Volunteers</a></li>
                <li><a href="https://git-wip-us.apache.org/repos/asf?p=struts.git">Source Repository</a></li>
              </ul>
            </li>
            <li class="apache"><a href="http://www.apache.org/"><img src="/img/apache.png"></a></li>
          </ul>
        </div>
      </div>
    </div>
  </nav>
</header>


<article class="container">
  <section class="col-md-12">
    <a href="index.html" title="back to Core Developers Guide"><< back to Core Developers Guide</a>
    <a class="edit-on-gh" href="https://github.com/apache/struts-site/edit/master/source/core-developers/stream-result.md" title="Edit this page on GitHub">Edit on GitHub</a>
    <h1 id="stream-result">Stream Result</h1>

<p>A custom Result type for sending raw data (via an InputStream) directly to the HttpServletResponse. Very useful for allowing users to download content.</p>

<table>
  <tbody>
    <tr>
      <td>If you are running your app server under HTTPS and having issues with PDF’s or other file streams you should take a look at <a href="https-and-ie-issues.html">HTTPS and IE Issues</a></td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
    </tr>
  </tbody>
</table>

<p>####Parameters####</p>

<ul>
  <li><strong>contentType</strong> - the stream mime-type as sent to the web browser (default =</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>text/plain
</code></pre>
</div>
<p>).</p>

<ul>
  <li>
    <p><strong>contentLength</strong> - the stream length in bytes (the browser displays a progress bar).</p>
  </li>
  <li>
    <p><strong>contentDisposition</strong> - the content disposition header value for specifying the file name (default =</p>
  </li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>inline
</code></pre>
</div>
<p>, values are typically <em>attachment;filename=”document.pdf”</em> .</p>

<ul>
  <li>
    <p><strong>inputName </strong>- the name of the InputStream property from the chained action (default = <strong>inputStream</strong>).</p>
  </li>
  <li>
    <p><strong>bufferSize </strong>- the size of the buffer to copy from input to output (default =</p>
  </li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>1024
</code></pre>
</div>
<p>).</p>

<ul>
  <li><strong>allowCaching</strong> - if set to ‘false’ it will set the headers</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>Pragma
</code></pre>
</div>
<p> and</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Cache-Control
</code></pre>
</div>
<p> to</p>

<div class="highlighter-rouge"><pre class="highlight"><code>no-cahce
</code></pre>
</div>
<p>, and prevent client from caching the content (default =</p>

<div class="highlighter-rouge"><pre class="highlight"><code>true
</code></pre>
</div>
<p>).</p>

<ul>
  <li><strong>contentCharSet</strong> - if set to a string, ‘;charset=value’ will be added to the content-type header, where value is the string set. If set to an expression, the result of evaluating the expression will be used. If not set, then no charset will be set on the header</li>
</ul>

<p>These parameters can also be set by exposing a similarly named getter method on your Action. For example, you can provide</p>

<div class="highlighter-rouge"><pre class="highlight"><code>getContentType()
</code></pre>
</div>
<p> to override that parameter for the current action. To do it you you must explicitly define this param as an expression i.e.</p>

<p><strong>parameter defined as an expression</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;param name="contentType"&gt;${contentType}&lt;/param&gt;
</code></pre>
</div>

<table>
  <tbody>
    <tr>
      <td>Please be aware that this was changed since Struts 2.5.2, previously each parameter was automagically resolved by looking throughout the ValueStack, now you must explicitly define wich parameter must be evaluated, even inputName.</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
    </tr>
  </tbody>
</table>

<p>####Examples####</p>

<p>#####Annotation based Configuration#####</p>

<p>To configure Actions and Results with Annotations you need to activate the Struts2 <em>Convention Plugin</em>  in your Struts2 application.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>package com.mycompany.webapp.actions;

import java.io.File;
import java.io.FileInputStream;
import java.io.InputStream;

import org.apache.struts2.convention.annotation.Result;

import com.opensymphony.xwork2.Action;
import com.opensymphony.xwork2.ActionSupport;

@Result(
	name = "success", 
	type = "stream", 
	params = { 
		"contentType", "${type}", 
		"inputName", "${stream}", 
		"bufferSize", "1024", 
		"contentDisposition", "attachment;filename=\"${filename}\"" 
	}
)
public class FileDisplay extends ActionSupport {

	private String type = "image/jpeg";
	private String filename;
	private InputStream stream;

	public String execute() throws Exception {

		filename = "myimage.jpg";
		File img = new File("/path/to/image/image.jpg");
		stream = new FileInputStream(img);

		return Action.SUCCESS;
	}
	
	private String getType() {
		return this.type;
	}
	
	private String getFilename() {
		return this.filename;
	}
	
	private String getStream() {
		return this.stream;
	}
}

</code></pre>
</div>

<p>#####XML based Configuration#####</p>

<p><strong>Example configuration</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;result name="success" type="stream"&gt;
  &lt;param name="contentType"&gt;image/jpeg&lt;/param&gt;
  &lt;param name="inputName"&gt;${imageStream}&lt;/param&gt;
  &lt;param name="contentDisposition"&gt;attachment;filename="document.pdf"&lt;/param&gt;
  &lt;param name="bufferSize"&gt;1024&lt;/param&gt;
&lt;/result&gt;
</code></pre>
</div>

  </section>
</article>


<footer class="container">
  <div class="col-md-12">
    Copyright &copy; 2000-2016 <a href="http://www.apache.org/">The Apache Software Foundation </a>.
    All Rights Reserved.
  </div>
  <div class="col-md-12">
    Apache Struts, Struts, Apache, the Apache feather logo, and the Apache Struts project logos are
    trademarks of The Apache Software Foundation.
  </div>
  <div class="col-md-12">Logo and website design donated by <a href="https://softwaremill.com/">SoftwareMill</a>.</div>
</footer>

<script>!function (d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (!d.getElementById(id)) {
    js = d.createElement(s);
    js.id = id;
    js.src = "//platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js, fjs);
  }
}(document, "script", "twitter-wjs");</script>
<script src="https://apis.google.com/js/platform.js" async="async" defer="defer"></script>

<div id="fb-root"></div>

<script>(function (d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s);
  js.id = id;
  js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>


<script>
$(function() {
  return $("h2, h3, h4, h5, h6").each(function(i, el) {
    var $el, id;
    $el = $(el);
    id = $el.attr('id');
    if (id) {
      $el.removeAttr('id');
      return $el.before($("<a />").addClass('anchor').attr('name', id));
    }
  });
});
</script>

</body>
</html>
